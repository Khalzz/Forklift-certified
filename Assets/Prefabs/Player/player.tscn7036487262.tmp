[gd_scene load_steps=20 format=3 uid="uid://b8wm5aids0hsd"]

[ext_resource type="Script" uid="uid://cf61wgupyo1jn" path="res://Assets/Scripts/player.gd" id="1_a6fu1"]
[ext_resource type="Script" uid="uid://c84ykpjmg20bk" path="res://Scenes/camera.gd" id="2_f2qr2"]
[ext_resource type="Texture2D" uid="uid://dtcx7mqa1mrtp" path="res://Assets/Sprites/Arrow.svg" id="3_uijvq"]
[ext_resource type="PackedScene" uid="uid://rnlbjyt78edc" path="res://Assets/Models/forklift.glb" id="4_47ure"]
[ext_resource type="Script" uid="uid://b1eh2dah8x45" path="res://Assets/Scripts/Player/normal_detection.gd" id="5_kct70"]
[ext_resource type="Texture2D" uid="uid://dqwep4p137nib" path="res://Assets/Sprites/Sparks.svg" id="6_4xvwh"]
[ext_resource type="Script" uid="uid://bvg1d7jg2ynxq" path="res://Assets/Scripts/Player/grind_checker.gd" id="7_g7r1l"]
[ext_resource type="PackedScene" uid="uid://cr0h0q780l4sw" path="res://Assets/Prefabs/Player/Ui.tscn" id="8_t514h"]
[ext_resource type="Script" uid="uid://cciub86iwsl6u" path="res://Assets/Scripts/Player/StateMachine/state_machine.gd" id="9_jhk03"]
[ext_resource type="Script" uid="uid://drrpbr3low47p" path="res://Assets/Scripts/Player/StateMachine/jumping.gd" id="10_ty6qv"]
[ext_resource type="Script" uid="uid://cfv4cisxi8pcs" path="res://Assets/Scripts/Player/StateMachine/running.gd" id="11_qmb3c"]
[ext_resource type="Script" uid="uid://c3u6dvv8a7lnn" path="res://Assets/Scripts/Player/StateMachine/idle.gd" id="12_fhc2p"]
[ext_resource type="Script" uid="uid://b30gkcaddh03e" path="res://Assets/Scripts/Player/StateMachine/falling.gd" id="13_8j4km"]
[ext_resource type="Script" uid="uid://cyvw2df3lkh7y" path="res://Assets/Scripts/Player/StateMachine/grinding.gd" id="14_5k530"]

[sub_resource type="SphereMesh" id="SphereMesh_8d4ee"]

[sub_resource type="ImmediateMesh" id="ImmediateMesh_x8mav"]

[sub_resource type="PhysicsMaterial" id="PhysicsMaterial_ko2s7"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_a6fu1"]
radius = 0.0841897
height = 0.275166

[sub_resource type="SphereShape3D" id="SphereShape3D_wjxug"]
radius = 0.735003

[node name="Player" type="Node3D" node_paths=PackedStringArray("model", "ground_ray", "rigid_body", "ui")]
script = ExtResource("1_a6fu1")
model = NodePath("RigidBody/forklift")
ground_ray = NodePath("RigidBody/GroundRays/GroundRayLB")
rigid_body = NodePath("RigidBody")
ui = NodePath("Ui")

[node name="Camera" type="Camera3D" parent="." node_paths=PackedStringArray("followable")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.189186, 0)
fov = 80.0
script = ExtResource("2_f2qr2")
followable = NodePath("../RigidBody")

[node name="Direction" type="Sprite3D" parent="."]
transform = Transform3D(0.1, 0, 0, 0, -4.37114e-09, -0.1, 0, 0.1, -4.37114e-09, 0, 0.1, 0.5)
texture_filter = 0
texture = ExtResource("3_uijvq")

[node name="Direction2" type="Sprite3D" parent="."]
transform = Transform3D(0.1, 0, 0, 0, -4.37114e-09, -0.1, 0, 0.1, -4.37114e-09, 0, 0.1, 0.5)
modulate = Color(0.677948, 0.000351258, 0.679375, 1)
texture_filter = 0
texture = ExtResource("3_uijvq")

[node name="Debug" type="Node3D" parent="."]

[node name="DebuggerGrind" type="MeshInstance3D" parent="Debug"]
transform = Transform3D(0.1, 0, 0, 0, 0.1, 0, 0, 0, 0.1, 0, 0, 0)
visible = false
mesh = SubResource("SphereMesh_8d4ee")
skeleton = NodePath("../../RigidBody/GrindChecker")

[node name="Grind" type="Node" parent="Debug"]

[node name="LineGrind" type="MeshInstance3D" parent="Debug/Grind"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.0531898, 2.38419e-07, -0.0206695)
mesh = SubResource("ImmediateMesh_x8mav")
skeleton = NodePath("../..")

[node name="RigidBody" type="RigidBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.2, 0)
physics_material_override = SubResource("PhysicsMaterial_ko2s7")
lock_rotation = true

[node name="NormalDetection" type="RayCast3D" parent="RigidBody" node_paths=PackedStringArray("player")]
target_position = Vector3(0, -0.5, 0)
script = ExtResource("5_kct70")
player = NodePath("..")

[node name="forklift" parent="RigidBody" instance=ExtResource("4_47ure")]
transform = Transform3D(0.1, 0, 0, 0, 0.1, 0, 0, 0, 0.1, 0, -0.171423, 0)

[node name="CollisionShape3D" type="CollisionShape3D" parent="RigidBody"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.00645447, -0.0295027, -0.011139)
shape = SubResource("CapsuleShape3D_a6fu1")

[node name="GroundRays" type="Node3D" parent="RigidBody"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.0457289, 0)

[node name="GroundRayLB" type="RayCast3D" parent="RigidBody/GroundRays"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.0929285, -0.0820668, -0.121893)
target_position = Vector3(0, -0.1, 0)

[node name="GroundRayRB" type="RayCast3D" parent="RigidBody/GroundRays"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.093, -0.082, -0.122)
target_position = Vector3(0, -0.1, 0)

[node name="GroundRayRF" type="RayCast3D" parent="RigidBody/GroundRays"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.0964047, -0.0820668, 0.0787327)
target_position = Vector3(0, -0.1, 0)

[node name="GroundRayLF" type="RayCast3D" parent="RigidBody/GroundRays"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.096, -0.082, 0.079)
target_position = Vector3(0, -0.1, 0)

[node name="Sparks" type="Node3D" parent="RigidBody"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.143928, -0.118351)

[node name="LeftSpark" type="Sprite3D" parent="RigidBody/Sparks"]
transform = Transform3D(0.012941, 0, 0.0482963, 0, 0.05, 0, -0.0482963, 0, 0.012941, 0.137486, 0.0887101, -0.162268)
texture = ExtResource("6_4xvwh")

[node name="RightSpark" type="Sprite3D" parent="RigidBody/Sparks"]
transform = Transform3D(-0.012941, 0, 0.0482963, 0, 0.05, 0, -0.0482963, 0, -0.012941, -0.137678, 0.0887101, -0.162268)
texture = ExtResource("6_4xvwh")

[node name="GrindChecker" type="Area3D" parent="RigidBody" node_paths=PackedStringArray("base_player")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.0450869, 0)
script = ExtResource("7_g7r1l")
base_player = NodePath("../..")

[node name="CollisionShape3D" type="CollisionShape3D" parent="RigidBody/GrindChecker"]
shape = SubResource("SphereShape3D_wjxug")

[node name="Ui" parent="." instance=ExtResource("8_t514h")]

[node name="StateMachine" type="Node" parent="." node_paths=PackedStringArray("base_player", "ground_rays", "rigid_body", "idle_node", "jumping_node", "running_node", "falling_node", "grinding_node", "direction_arrow")]
script = ExtResource("9_jhk03")
base_player = NodePath("..")
ground_rays = NodePath("../RigidBody/GroundRays")
rigid_body = NodePath("../RigidBody")
idle_node = NodePath("Idle")
jumping_node = NodePath("Jumping")
running_node = NodePath("Running")
falling_node = NodePath("Falling")
grinding_node = NodePath("Grinding")
direction_arrow = NodePath("../Direction")

[node name="Jumping" type="Node" parent="StateMachine"]
script = ExtResource("10_ty6qv")

[node name="Running" type="Node" parent="StateMachine"]
script = ExtResource("11_qmb3c")

[node name="Idle" type="Node" parent="StateMachine"]
script = ExtResource("12_fhc2p")

[node name="Falling" type="Node" parent="StateMachine"]
script = ExtResource("13_8j4km")

[node name="Grinding" type="Node" parent="StateMachine" node_paths=PackedStringArray("rigid_body", "line_grind")]
script = ExtResource("14_5k530")
rigid_body = NodePath("../../RigidBody")
line_grind = NodePath("../../Debug/Grind/LineGrind")
