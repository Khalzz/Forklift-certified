[gd_scene load_steps=33 format=3 uid="uid://cyctv4o556y1e"]

[ext_resource type="Texture2D" uid="uid://bemvhniy4n5e6" path="res://Assets/Materials/orange.png" id="1_f2nln"]
[ext_resource type="Script" uid="uid://cf61wgupyo1jn" path="res://Assets/Scripts/player.gd" id="1_gxb1y"]
[ext_resource type="PackedScene" uid="uid://rnlbjyt78edc" path="res://Assets/Models/forklift.glb" id="1_ko2s7"]
[ext_resource type="Script" uid="uid://c84ykpjmg20bk" path="res://Scenes/camera.gd" id="2_0dy5s"]
[ext_resource type="Texture2D" uid="uid://dtcx7mqa1mrtp" path="res://Assets/Sprites/Arrow.svg" id="3_rarx8"]
[ext_resource type="Script" uid="uid://c3u6dvv8a7lnn" path="res://Assets/Scripts/Player/StateMachine/idle.gd" id="4_06fis"]
[ext_resource type="Script" uid="uid://cciub86iwsl6u" path="res://Assets/Scripts/Player/StateMachine/state_machine.gd" id="4_mma61"]
[ext_resource type="Script" uid="uid://drrpbr3low47p" path="res://Assets/Scripts/Player/StateMachine/jumping.gd" id="5_ki7sg"]
[ext_resource type="Script" uid="uid://bvg1d7jg2ynxq" path="res://Assets/Scripts/Player/grind_checker.gd" id="6_8d4ee"]
[ext_resource type="Script" uid="uid://cfv4cisxi8pcs" path="res://Assets/Scripts/Player/StateMachine/running.gd" id="6_kq4yt"]
[ext_resource type="PackedScene" uid="uid://cr0h0q780l4sw" path="res://Assets/Prefabs/Player/Ui.tscn" id="7_c5xim"]
[ext_resource type="Script" uid="uid://b30gkcaddh03e" path="res://Assets/Scripts/Player/StateMachine/falling.gd" id="7_rxb08"]
[ext_resource type="Texture2D" uid="uid://dqwep4p137nib" path="res://Assets/Sprites/Sparks.svg" id="10_wjxug"]
[ext_resource type="Script" uid="uid://cyvw2df3lkh7y" path="res://Assets/Scripts/Player/StateMachine/grinding.gd" id="13_b07cf"]
[ext_resource type="PackedScene" uid="uid://j8r2xo6jof" path="res://Assets/Prefabs/blocks/grindable.tscn" id="15_c5xim"]
[ext_resource type="PackedScene" uid="uid://b8jh63vm3tr0h" path="res://Assets/Prefabs/blocks/box.tscn" id="16_b07cf"]
[ext_resource type="PackedScene" uid="uid://3n18bokpi40a" path="res://Assets/Prefabs/Grind/grind_path.tscn" id="16_x8mav"]

[sub_resource type="ProceduralSkyMaterial" id="ProceduralSkyMaterial_f2nln"]
sky_horizon_color = Color(0.662243, 0.671743, 0.686743, 1)
ground_horizon_color = Color(0.662243, 0.671743, 0.686743, 1)

[sub_resource type="Sky" id="Sky_efk68"]
sky_material = SubResource("ProceduralSkyMaterial_f2nln")

[sub_resource type="Environment" id="Environment_06fis"]
background_mode = 1
background_color = Color(0.509306, 0.667922, 1, 1)
sky = SubResource("Sky_efk68")
tonemap_mode = 2
fog_light_energy = 13.46

[sub_resource type="SphereMesh" id="SphereMesh_8d4ee"]

[sub_resource type="ImmediateMesh" id="ImmediateMesh_x8mav"]

[sub_resource type="PhysicsMaterial" id="PhysicsMaterial_ko2s7"]

[sub_resource type="BoxShape3D" id="BoxShape3D_efk68"]
size = Vector3(0.217926, 0.279831, 0.319763)

[sub_resource type="SphereShape3D" id="SphereShape3D_wjxug"]
radius = 0.735003

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_efk68"]
albedo_texture = ExtResource("1_f2nln")
uv1_triplanar = true
uv1_world_triplanar = true
texture_filter = 0

[sub_resource type="PlaneMesh" id="PlaneMesh_gxb1y"]

[sub_resource type="PhysicsMaterial" id="PhysicsMaterial_0dy5s"]
friction = 0.7

[sub_resource type="BoxShape3D" id="BoxShape3D_f2nln"]
size = Vector3(1, 0.0229492, 1)

[sub_resource type="Curve3D" id="Curve3D_65pw5"]
_data = {
"points": PackedVector3Array(0, 0, 0, 0, 0, 0, 0, 0, -0.5, 0, 0, 0, 0, 0, 0, 0, 0, 0.5),
"tilts": PackedFloat32Array(0, 0)
}
point_count = 2

[sub_resource type="Curve3D" id="Curve3D_07y4a"]
_data = {
"points": PackedVector3Array(0, 0, 0, 0, 0, 0, 0, 0, -0.5, 0, 0, 0, 0, 0, 0, 0, 0, 0.5),
"tilts": PackedFloat32Array(0, 0)
}
point_count = 2

[sub_resource type="Curve3D" id="Curve3D_x8mav"]
_data = {
"points": PackedVector3Array(0, 0, 0, 0, 0, 0, -0.5, 0, -0.5, 0, 0, 0, 0, 0, 0, 0.5, 0, -0.5, 0, 0, 0, 0, 0, 0, 0.5, 0, 0.5, 0, 0, 0, 0, 0, 0, -0.5, 0, 0.5, 0, 0, 0, 0, 0, 0, -0.5, 0, -0.5),
"tilts": PackedFloat32Array(0, 0, 0, 0, 0)
}
point_count = 5

[node name="World" type="Node3D"]

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_06fis")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 0.0977219, 0.995214, 0, -0.995214, 0.0977219, 0, 20.9353, 0)
light_volumetric_fog_energy = 0.0
light_specular = 0.0
shadow_enabled = true
shadow_blur = 1.312
directional_shadow_max_distance = 91.3

[node name="Player" type="Node3D" parent="." node_paths=PackedStringArray("model", "ground_ray", "rigid_body", "ui")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.0531898, 2.38419e-07, -0.0206695)
script = ExtResource("1_gxb1y")
model = NodePath("RigidBody/forklift")
ground_ray = NodePath("RigidBody/GroundRays/GroundRayLB")
rigid_body = NodePath("RigidBody")
ui = NodePath("Ui")

[node name="Camera" type="Camera3D" parent="Player" node_paths=PackedStringArray("followable")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.189186, 0)
fov = 80.0
script = ExtResource("2_0dy5s")
followable = NodePath("../RigidBody")

[node name="Direction" type="Sprite3D" parent="Player"]
transform = Transform3D(0.1, 0, 0, 0, -4.37114e-09, -0.1, 0, 0.1, -4.37114e-09, 0, 0.1, 0.5)
texture_filter = 0
texture = ExtResource("3_rarx8")

[node name="Debug" type="Node3D" parent="Player"]

[node name="DebuggerGrind" type="MeshInstance3D" parent="Player/Debug"]
transform = Transform3D(0.1, 0, 0, 0, 0.1, 0, 0, 0, 0.1, 0, 0, 0)
visible = false
mesh = SubResource("SphereMesh_8d4ee")
skeleton = NodePath("../../RigidBody/GrindChecker")

[node name="Grind" type="Node" parent="Player/Debug"]

[node name="LineGrind" type="MeshInstance3D" parent="Player/Debug/Grind"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.0531898, 2.38419e-07, -0.0206695)
mesh = SubResource("ImmediateMesh_x8mav")
skeleton = NodePath("../..")

[node name="RigidBody" type="RigidBody3D" parent="Player"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.2, 0)
physics_material_override = SubResource("PhysicsMaterial_ko2s7")
lock_rotation = true

[node name="forklift" parent="Player/RigidBody" instance=ExtResource("1_ko2s7")]
transform = Transform3D(0.1, 0, 0, 0, 0.1, 0, 0, 0, 0.1, 0, -0.171423, 0)

[node name="CollisionShape3D" type="CollisionShape3D" parent="Player/RigidBody"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.00645447, -0.0295027, -0.011139)
shape = SubResource("BoxShape3D_efk68")

[node name="GroundRays" type="Node3D" parent="Player/RigidBody"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.0457289, 0)

[node name="GroundRayLB" type="RayCast3D" parent="Player/RigidBody/GroundRays"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.0929285, -0.0820668, -0.121893)
target_position = Vector3(0, -0.1, 0)

[node name="GroundRayRB" type="RayCast3D" parent="Player/RigidBody/GroundRays"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.093, -0.082, -0.122)
target_position = Vector3(0, -0.1, 0)

[node name="GroundRayRF" type="RayCast3D" parent="Player/RigidBody/GroundRays"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.0964047, -0.0820668, 0.0787327)
target_position = Vector3(0, -0.1, 0)

[node name="GroundRayLF" type="RayCast3D" parent="Player/RigidBody/GroundRays"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.096, -0.082, 0.079)
target_position = Vector3(0, -0.1, 0)

[node name="Sparks" type="Node3D" parent="Player/RigidBody"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.143928, -0.118351)

[node name="LeftSpark" type="Sprite3D" parent="Player/RigidBody/Sparks"]
transform = Transform3D(0.012941, 0, 0.0482963, 0, 0.05, 0, -0.0482963, 0, 0.012941, 0.137486, 0.0887101, -0.162268)
texture = ExtResource("10_wjxug")

[node name="RightSpark" type="Sprite3D" parent="Player/RigidBody/Sparks"]
transform = Transform3D(-0.012941, 0, 0.0482963, 0, 0.05, 0, -0.0482963, 0, -0.012941, -0.137678, 0.0887101, -0.162268)
texture = ExtResource("10_wjxug")

[node name="GrindChecker" type="Area3D" parent="Player/RigidBody" node_paths=PackedStringArray("base_player")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.0450869, 0)
script = ExtResource("6_8d4ee")
base_player = NodePath("../..")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Player/RigidBody/GrindChecker"]
shape = SubResource("SphereShape3D_wjxug")

[node name="Ui" parent="Player" instance=ExtResource("7_c5xim")]

[node name="StateMachine" type="Node" parent="Player" node_paths=PackedStringArray("base_player", "ground_rays", "rigid_body", "idle_node", "jumping_node", "running_node", "falling_node", "grinding_node", "direction_arrow")]
script = ExtResource("4_mma61")
base_player = NodePath("..")
ground_rays = NodePath("../RigidBody/GroundRays")
rigid_body = NodePath("../RigidBody")
idle_node = NodePath("Idle")
jumping_node = NodePath("Jumping")
running_node = NodePath("Running")
falling_node = NodePath("Falling")
grinding_node = NodePath("Grinding")
direction_arrow = NodePath("../Direction")

[node name="Jumping" type="Node" parent="Player/StateMachine"]
script = ExtResource("5_ki7sg")

[node name="Running" type="Node" parent="Player/StateMachine"]
script = ExtResource("6_kq4yt")

[node name="Idle" type="Node" parent="Player/StateMachine"]
script = ExtResource("4_06fis")

[node name="Falling" type="Node" parent="Player/StateMachine"]
script = ExtResource("7_rxb08")

[node name="Grinding" type="Node" parent="Player/StateMachine" node_paths=PackedStringArray("rigid_body", "line_grind")]
script = ExtResource("13_b07cf")
rigid_body = NodePath("../../RigidBody")
line_grind = NodePath("../../Debug/Grind/LineGrind")

[node name="Floor" type="Node3D" parent="."]
transform = Transform3D(100, 0, 0, 0, 1, 0, 0, 0, 100, 0, 0, 0)

[node name="FloorMesh" type="MeshInstance3D" parent="Floor"]
transform = Transform3D(0.5, 0, 0, 0, 0.5, 0, 0, 0, 0.5, 0, 0, 0)
material_override = SubResource("StandardMaterial3D_efk68")
mesh = SubResource("PlaneMesh_gxb1y")

[node name="StaticBody3D" type="StaticBody3D" parent="Floor/FloorMesh"]
transform = Transform3D(2, 0, 0, 0, 2, 0, 0, 0, 2, 0, 0, 0)
physics_material_override = SubResource("PhysicsMaterial_0dy5s")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Floor/FloorMesh/StaticBody3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.0127389, 0)
shape = SubResource("BoxShape3D_f2nln")

[node name="Boxes" type="Node3D" parent="."]

[node name="Grindable" parent="Boxes" instance=ExtResource("15_c5xim")]
transform = Transform3D(1, 0, 0, 0, 0.8, 0, 0, 0, 1, 3.22108, 0, 2.99637)

[node name="GrindPath" parent="Boxes/Grindable" instance=ExtResource("16_x8mav")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.499175, 0)
curve = SubResource("Curve3D_65pw5")

[node name="Grindable2" parent="Boxes" instance=ExtResource("15_c5xim")]
transform = Transform3D(1, 0, 0, 0, 0.8, 0, 0, 0, 1, 0.00552225, 0, 2.99637)

[node name="GrindPath" parent="Boxes/Grindable2" instance=ExtResource("16_x8mav")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.499175, 0)
curve = SubResource("Curve3D_07y4a")

[node name="box" parent="Boxes" instance=ExtResource("16_b07cf")]
transform = Transform3D(3, 0, 0, 0, 0.5, 0, 0, 0, 3, 0.317309, 0.215767, 8.22291)

[node name="GrindPath" parent="Boxes/box" instance=ExtResource("16_x8mav")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.499175, 0)
curve = SubResource("Curve3D_x8mav")

[node name="box2" parent="Boxes" instance=ExtResource("16_b07cf")]
transform = Transform3D(3, 0, 0, 0, 0.5, 0, 0, 0, 3, -1.41654, 0.440471, 12.4791)
